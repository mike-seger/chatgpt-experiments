<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta viewport="width=device-width, initial-scale=1.0">
    <title>Animated and Pixelated SVG</title>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background: black;
        }
        canvas {
            width: 400px;
            height: 400px;
            border: 1px solid white; /* For visibility */
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const svg = `
            <svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <path fill="white" d="M25,0 L30,16.3397 L46.6506,12.5 L35,25 L46.6506,37.5 L30,33.6603 L25,50 L20,33.6603 L3.3494,37.5 L15,25 L3.3494,12.5 L20,16.3397 Z"/>
            </svg>
        `;
        const img = new Image();
        const svgBlob = new Blob([svg], { type: 'image/svg+xml;charset=utf-8' });
        const url = URL.createObjectURL(svgBlob);

        img.onload = function() {
            animate(0); // Start the animation once the image is loaded
        };
        img.src = url;

        function animate(angle) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Redraw the image rotated, properly centered and scaled
            ctx.save();
            ctx.translate(canvas.width / 2, canvas.height / 2);
            ctx.rotate(angle * Math.PI / 180);
            ctx.drawImage(img, -img.width / 2, -img.height / 2, img.width, img.height);
            ctx.restore();

            // Update the rotation
            let newAngle = angle + 3;
            if (newAngle >= 360) newAngle = 0;

            pixelate();
            requestAnimationFrame(() => animate(newAngle)); // Continue the animation loop
        }

        function pixelate() {
            const pixelSizeX = 20; // Width of the block
            const pixelSizeY = 10; // Height of the block
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;

            for (let y = 0; y < canvas.height; y += pixelSizeY) {
                for (let x = 0; x < canvas.width; x += pixelSizeX) {
                    let red = 0, green = 0, blue = 0, alpha = 0, count = 0;
                    
                    for (let dy = 0; dy < pixelSizeY; dy++) {
                        for (let dx = 0; dx < pixelSizeX; dx++) {
                            const index = ((y + dy) * canvas.width + (x + dx)) * 4;
                            red += data[index];
                            green += data[index + 1];
                            blue += data[index + 2];
                            alpha += data[index + 3];
                            count++;
                        }
                    }

                    const avgRed = red / count;
                    const avgGreen = green / count;
                    const avgBlue = blue / count;
                    const avgAlpha = alpha / count;

                    ctx.fillStyle = `rgba(${avgRed}, ${avgGreen}, ${avgBlue}, ${avgAlpha / 255})`;
                    ctx.fillRect(x, y, pixelSizeX, pixelSizeY);
                }
            }
        }
    </script>
</body>
</html>
